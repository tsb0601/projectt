/home/tsb/.local/lib/python3.10/site-packages/webdataset/compat.py:136: UserWarning: WebDataset(shardshuffle=...) is None; set explicitly to False or a number
  warnings.warn("WebDataset(shardshuffle=...) is None; set explicitly to False or a number")
/home/tsb/.local/lib/python3.10/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
buggggggggggggggggg
features {'layer_0': (tensor([[[-0.0022, -0.0409,  0.0079,  ..., -0.0093, -0.0104,  0.0070],
         [-0.0201, -0.0107, -0.0150,  ..., -0.0188, -0.0274,  0.0046],
         [-0.0146, -0.0209, -0.0267,  ..., -0.0244, -0.0267,  0.0541],
         ...,
         [ 0.0285,  0.0072,  0.0031,  ..., -0.0032, -0.0254,  0.0192],
         [ 0.0499, -0.0114, -0.0320,  ..., -0.0012, -0.0594, -0.0060],
         [ 0.0117,  0.0149, -0.0181,  ...,  0.0074, -0.0308, -0.0419]],

        [[-0.0039, -0.0384,  0.0290,  ..., -0.0051, -0.0086,  0.0027],
         [ 0.0026,  0.0162, -0.0139,  ..., -0.0029, -0.0301, -0.0060],
         [ 0.0020,  0.0094, -0.0191,  ..., -0.0080, -0.0224,  0.0353],
         ...,
         [ 0.0581, -0.0102,  0.0195,  ..., -0.0073,  0.0057,  0.0102],
         [-0.0006,  0.0173, -0.0072,  ..., -0.0024,  0.0025,  0.0101],
         [ 0.0279,  0.0771, -0.0266,  ...,  0.0149, -0.0485, -0.0033]],

        [[-0.0058, -0.0395,  0.0018,  ..., -0.0098, -0.0125,  0.0004],
         [ 0.0332,  0.0435, -0.0375,  ..., -0.0016, -0.0255,  0.0212],
         [ 0.0308,  0.0227, -0.0188,  ...,  0.0326, -0.0255,  0.1208],
         ...,
         [-0.0085,  0.0117, -0.0212,  ..., -0.0063, -0.0348, -0.0290],
         [-0.0074,  0.0148, -0.0255,  ..., -0.0007, -0.0272, -0.0326],
         [ 0.0068,  0.0163, -0.0249,  ..., -0.0064, -0.0277, -0.0114]],

        ...,

        [[-0.0071, -0.0369,  0.0183,  ..., -0.0003, -0.0103, -0.0020],
         [-0.0060,  0.0058, -0.0065,  ..., -0.0109, -0.0182,  0.0379],
         [-0.0806,  0.0210,  0.0079,  ..., -0.0165, -0.0359,  0.1423],
         ...,
         [-0.0641,  0.0308, -0.0522,  ..., -0.0287, -0.0133, -0.0429],
         [-0.0358,  0.0344, -0.0301,  ..., -0.0132,  0.0092, -0.0458],
         [ 0.0445, -0.0054, -0.0392,  ..., -0.0123, -0.0084, -0.0576]],

        [[-0.0003, -0.0403,  0.0191,  ..., -0.0062, -0.0064, -0.0034],
         [ 0.0062,  0.0185, -0.0067,  ...,  0.0003, -0.0348, -0.0204],
         [ 0.0031,  0.0125, -0.0115,  ..., -0.0037, -0.0272,  0.0207],
         ...,
         [-0.0505, -0.0318, -0.0196,  ...,  0.0219, -0.0478,  0.0105],
         [ 0.0206, -0.0241,  0.0169,  ..., -0.0247, -0.0104,  0.0286],
         [ 0.0285,  0.0229, -0.0036,  ..., -0.0002, -0.0175,  0.0134]],

        [[-0.0091, -0.0414,  0.0189,  ..., -0.0078, -0.0071, -0.0041],
         [ 0.0096,  0.0185, -0.0132,  ...,  0.0009, -0.0302, -0.0031],
         [-0.0653, -0.0039, -0.0157,  ..., -0.0348, -0.0023,  0.0642],
         ...,
         [-0.0377, -0.0205, -0.0036,  ..., -0.0405, -0.0130, -0.0344],
         [-0.0054,  0.0057, -0.0199,  ...,  0.0105, -0.0284, -0.0665],
         [ 0.0076,  0.0076, -0.0182,  ...,  0.0068, -0.0282, -0.0460]]],
       device='xla:0'),), 'layer_1': (tensor([[[-8.1506e-03, -5.5169e-02,  2.6243e-02,  ...,  2.5633e-02,
          -2.0162e-02, -4.4121e-02],
         [-3.9414e-02, -5.7311e-03,  9.4377e-02,  ...,  6.5345e-02,
          -2.1647e-02,  1.6450e-02],
         [-8.1476e-02,  3.5004e-02, -5.0635e-02,  ...,  5.5033e-02,
          -1.1126e-02,  4.8599e-02],
         ...,
         [ 1.8300e-01, -7.1764e-02,  7.9781e-02,  ...,  8.0800e-03,
          -7.9694e-03, -2.3623e-01],
         [-5.9020e-02, -6.6204e-02,  2.6027e-02,  ...,  1.8927e-02,
          -1.0262e-01, -1.0640e-01],
         [-1.3586e-03,  4.5039e-02,  1.5432e-01,  ..., -3.6153e-02,
          -4.5139e-02, -9.3790e-02]],

        [[-1.1725e-02, -3.1917e-02,  5.1890e-02,  ..., -5.3583e-03,
          -2.4825e-02,  3.5379e-02],
         [-7.3809e-02, -4.2864e-02,  4.8381e-02,  ...,  2.0005e-02,
           3.2191e-03,  4.8037e-02],
         [-3.1395e-02, -1.9718e-02,  7.1267e-02,  ...,  1.3815e-02,
           2.5289e-02,  8.9852e-02],
         ...,
         [-3.6920e-03, -5.1600e-02,  5.0321e-02,  ...,  6.6622e-02,
          -1.1631e-01, -1.9534e-01],
         [ 2.8493e-02, -7.3698e-02,  2.0383e-02,  ..., -3.9275e-02,
          -8.6388e-02, -2.9616e-02],
         [ 5.4928e-02, -6.8130e-02,  9.8518e-02,  ...,  6.3123e-02,
          -6.1702e-02, -1.1324e-01]],

        [[-3.6933e-02, -2.8534e-02, -8.3477e-03,  ...,  2.7879e-02,
          -2.9725e-02, -2.6036e-02],
         [ 2.7688e-03,  8.6744e-02,  1.6317e-01,  ..., -2.7187e-02,
          -2.3012e-03, -6.9859e-02],
         [ 1.3429e-01,  3.2568e-02, -1.3886e-02,  ...,  5.0377e-02,
           5.3646e-02,  2.4188e-01],
         ...,
         [-3.8134e-02, -6.6967e-02,  6.0398e-02,  ...,  5.7120e-03,
          -1.9546e-02, -8.2509e-03],
         [-1.9622e-02, -4.0734e-02,  6.4660e-02,  ..., -9.1774e-03,
          -1.1728e-02, -1.5685e-01],
         [-4.3331e-02, -7.0482e-02,  9.5704e-02,  ...,  2.0705e-03,
          -8.1499e-03, -1.7184e-01]],

        ...,

        [[-2.3085e-02, -2.8444e-02,  1.7806e-02,  ..., -4.0000e-02,
          -7.2205e-02, -3.0932e-02],
         [-5.3926e-02,  1.1971e-01,  1.7504e-01,  ...,  2.4898e-02,
           4.4501e-02, -1.5436e-01],
         [-1.3156e-01,  9.9327e-02, -9.5716e-02,  ...,  3.1376e-02,
           1.3211e-02,  2.4461e-01],
         ...,
         [-7.5565e-02, -3.3581e-02,  8.5012e-02,  ...,  1.9441e-02,
          -1.3685e-01, -1.6668e-01],
         [-6.3828e-02,  1.8281e-02,  3.1132e-02,  ..., -7.1759e-02,
          -1.6916e-01, -3.9118e-02],
         [-5.7029e-02,  3.5893e-02,  1.3687e-01,  ...,  8.1758e-02,
          -1.1274e-01, -2.2847e-01]],

        [[-2.4357e-02, -2.3048e-02, -1.4802e-02,  ...,  4.3113e-04,
          -9.7345e-03, -5.7035e-02],
         [-5.2146e-02,  3.7295e-02,  9.9280e-02,  ..., -1.5762e-02,
          -2.1031e-02, -3.1723e-02],
         [-3.5308e-02,  7.1536e-02,  1.1182e-01,  ..., -1.2278e-03,
          -5.3043e-03, -2.7822e-02],
         ...,
         [ 3.8015e-02, -6.8094e-02, -8.5159e-03,  ...,  1.1112e-02,
           2.3884e-04,  1.0070e-02],
         [ 1.1291e-01, -9.4720e-02,  1.3551e-01,  ..., -4.0635e-02,
          -1.6507e-02, -1.3883e-01],
         [ 1.1402e-01, -1.7608e-02,  7.9696e-02,  ...,  1.0378e-02,
           4.4052e-02,  2.8565e-02]],

        [[-3.4054e-02, -4.8349e-02, -1.5723e-02,  ...,  5.3696e-02,
          -3.7054e-03, -4.8631e-02],
         [-2.2150e-02,  3.2486e-02,  1.3810e-01,  ...,  4.4276e-02,
          -1.2991e-02, -1.5736e-01],
         [-1.3500e-01,  3.8984e-02, -1.4994e-03,  ..., -7.9769e-03,
           5.5661e-03,  1.4877e-02],
         ...,
         [-7.1595e-02, -4.7982e-03,  1.7943e-01,  ...,  8.6980e-03,
          -9.5951e-02, -1.7510e-02],
         [-9.7153e-02,  3.5919e-02,  1.0707e-01,  ...,  7.7241e-02,
           2.7934e-03, -1.6054e-01],
         [-7.6327e-02, -2.1176e-02,  1.1587e-01,  ...,  6.9313e-02,
          -3.4354e-02, -2.0612e-01]]], device='xla:0'),), 'layer_2': (tensor([[[ 5.2444e-02, -4.3718e-02, -2.1656e-02,  ...,  6.6575e-01,
           1.5661e-01, -1.2147e-01],
         [ 4.7728e-01, -4.3345e-01,  1.9870e-01,  ...,  9.9040e-02,
          -3.4928e-01,  3.4448e-01],
         [ 5.9165e-02, -7.4592e-02, -3.0579e-01,  ...,  2.1481e-01,
          -1.2092e-01,  1.0143e-01],
         ...,
         [-1.7759e-01,  2.7065e-01, -3.9235e-02,  ...,  1.8516e-01,
           1.5113e-01, -1.3506e-01],
         [-3.0346e-01,  7.8222e-02, -1.7723e-01,  ...,  1.2922e-01,
           3.2613e-01,  2.5436e-01],
         [ 4.8320e-01,  1.0380e-01,  1.0690e-01,  ...,  1.0863e-01,
           1.1462e-01,  2.2036e-01]],

        [[ 2.4999e-01, -1.9532e-02,  2.3558e-01,  ...,  4.0779e-01,
           4.5896e-01,  1.2054e-02],
         [ 1.1654e-01, -3.1989e-01, -7.5951e-02,  ...,  7.6154e-02,
          -1.2892e-01,  2.5670e-01],
         [ 2.4984e-01, -4.0142e-01,  1.7041e-01,  ...,  2.9396e-01,
          -2.9986e-01,  4.0548e-01],
         ...,
         [ 1.5217e-01, -1.9571e-01,  6.2293e-02,  ...,  7.2738e-02,
           3.7042e-01, -3.0903e-01],
         [ 7.8301e-02, -3.8751e-02,  2.1928e-01,  ..., -8.2783e-02,
           4.2178e-02, -9.9529e-02],
         [-6.4941e-03, -1.9167e-01,  1.0711e-01,  ...,  3.0957e-01,
           3.1019e-01, -1.2072e-01]],

        [[ 2.1442e-02,  4.6361e-02, -3.1740e-04,  ...,  4.3946e-01,
          -2.2335e-01,  2.3970e-02],
         [ 3.6894e-01, -2.3322e-01,  5.6918e-02,  ...,  2.5501e-02,
           1.2463e-01, -1.9952e-01],
         [ 2.0544e-01,  2.3421e-01, -1.3562e-01,  ...,  3.2330e-01,
           2.3896e-02,  3.2792e-01],
         ...,
         [ 2.3562e-01, -3.0084e-01, -3.2525e-01,  ..., -1.6445e-01,
           5.3737e-01, -1.2127e-01],
         [ 4.3747e-01, -2.0092e-01, -7.3839e-02,  ...,  3.4058e-02,
           3.0959e-01, -2.1895e-01],
         [ 3.3811e-01, -1.9915e-01, -2.5287e-01,  ..., -3.3651e-01,
           3.5114e-01, -2.0625e-01]],

        ...,

        [[ 2.2202e-01,  9.6499e-02,  1.0797e-01,  ..., -1.2798e-02,
           2.3847e-01, -1.5288e-01],
         [ 3.2971e-01,  1.3729e-02,  2.1702e-01,  ..., -2.1028e-01,
          -2.9890e-01,  1.6240e-01],
         [-3.9748e-01,  1.4643e-02, -5.0491e-01,  ..., -1.7386e-01,
           2.8523e-01,  6.9365e-02],
         ...,
         [-2.9647e-01, -3.0599e-01, -7.9563e-02,  ..., -7.2570e-02,
           5.6143e-01, -4.8370e-01],
         [ 1.2657e-01, -4.1016e-02,  2.8439e-02,  ..., -4.0155e-02,
           1.2782e-01,  9.7106e-03],
         [ 1.0055e-01, -9.0254e-02, -1.2527e-01,  ..., -3.2097e-01,
           1.1403e-01, -1.4450e-01]],

        [[-2.7228e-02,  1.3821e-02,  6.8631e-02,  ...,  1.4972e-01,
           2.8839e-01, -2.1040e-01],
         [ 2.3305e-01,  4.5754e-02,  5.2896e-02,  ..., -3.5598e-02,
          -2.6158e-01,  3.3211e-01],
         [ 3.9163e-01, -1.4499e-01,  1.9918e-01,  ...,  6.9719e-02,
          -4.1187e-01,  4.1069e-01],
         ...,
         [-3.2804e-01,  5.0837e-01,  2.0183e-02,  ...,  4.3742e-01,
           8.1647e-02, -4.1907e-02],
         [-2.9349e-02, -1.4264e-01,  2.8570e-02,  ..., -3.2600e-01,
          -5.7309e-02, -2.4917e-01],
         [ 4.6515e-02,  2.5191e-01, -2.2410e-01,  ...,  2.2417e-01,
          -3.6293e-02,  1.8034e-01]],

        [[ 1.7457e-01, -6.4227e-02, -9.1149e-02,  ...,  5.3175e-01,
          -2.4471e-02, -2.4796e-01],
         [ 7.0578e-01,  7.5920e-02,  2.4921e-01,  ...,  1.6509e-01,
          -4.7398e-01,  2.3418e-02],
         [ 4.6622e-02, -1.8124e-02,  4.7678e-02,  ...,  1.2554e-01,
           2.0128e-01, -1.4959e-01],
         ...,
         [ 2.5802e-01,  4.3085e-01,  9.0347e-02,  ..., -6.2252e-02,
           2.8608e-01,  1.0774e-01],
         [ 2.5831e-01,  2.9694e-01,  3.3309e-01,  ...,  2.2515e-01,
          -7.3643e-02,  1.8059e-01],
         [ 1.6482e-01,  3.0161e-03, -3.2313e-02,  ...,  6.3561e-02,
          -1.0313e-02,  4.8136e-02]]], device='xla:0'),), 'layer_3': (tensor([[[ 3.7499e-02,  4.3607e-02, -7.6743e-01,  ...,  2.7468e+00,
           7.4584e-01, -3.4372e-02],
         [ 4.9831e+00, -3.0950e+00,  1.9997e+00,  ...,  9.5211e-01,
          -2.2207e+00,  2.1996e+00],
         [ 3.6552e+00, -6.0525e-01, -1.5653e+00,  ...,  8.0319e-01,
           3.7503e+00,  5.2755e-01],
         ...,
         [ 4.5985e-01, -8.6806e-02,  2.5895e+00,  ...,  3.8268e-01,
           7.8739e-01,  4.9859e-01],
         [ 1.0398e+00, -2.0347e-01,  1.5348e+00,  ...,  1.0406e+00,
           1.0785e+00,  7.7685e-01],
         [ 5.2227e+00, -1.3872e+00,  1.4406e+00,  ...,  2.0866e+00,
           4.5145e-01,  1.5810e+00]],

        [[ 1.7327e+00,  4.3989e+00,  2.0656e-01,  ..., -8.8446e-01,
          -3.9702e-01, -4.8284e-01],
         [ 3.6806e+00, -1.5708e+00,  1.1028e+00,  ..., -9.6765e-01,
          -2.8360e+00,  1.5024e+00],
         [ 3.3824e+00, -5.2224e+00,  3.5855e+00,  ...,  1.7363e-01,
          -2.8969e+00,  2.5232e+00],
         ...,
         [ 6.0990e-01,  3.5579e+00,  1.7051e-01,  ..., -1.5052e+00,
           1.7804e+00, -1.3105e+00],
         [ 1.6744e+00,  3.7303e+00,  1.6284e+00,  ..., -1.4630e+00,
           1.0667e+00,  1.3012e+00],
         [ 2.6739e+00,  1.1103e+00, -1.8713e+00,  ...,  1.8126e+00,
          -6.5929e-01,  4.8775e-01]],

        [[ 8.6823e-01, -6.4871e-03,  5.1358e-02,  ...,  5.2600e-01,
          -1.4570e+00,  4.6184e-01],
         [ 3.5674e+00, -2.3717e+00,  1.7630e+00,  ..., -8.5901e-01,
           6.3873e-01,  2.6238e+00],
         [ 4.8830e+00, -6.0451e-01, -7.1666e-01,  ..., -3.0293e-01,
          -2.5728e+00,  1.6493e+00],
         ...,
         [ 6.9594e-01, -8.3697e-01,  4.8058e-01,  ...,  2.0311e+00,
          -1.2364e+00,  1.8493e+00],
         [ 1.8119e+00, -1.4458e+00,  6.0837e-01,  ..., -2.9617e-01,
           1.9517e+00,  1.6508e+00],
         [ 2.2692e-01, -2.6312e+00, -6.9005e-01,  ...,  8.9904e-01,
          -1.4413e+00,  1.7151e+00]],

        ...,

        [[-1.1181e+00, -1.9369e+00,  1.3094e+00,  ...,  1.8857e+00,
          -1.4934e+00, -5.3516e-01],
         [ 7.6954e+00, -1.4452e+00, -3.5090e+00,  ..., -2.3276e+00,
          -1.2017e+00,  1.5326e+00],
         [ 1.3427e+00,  8.5334e-01, -3.6038e+00,  ..., -9.8087e-01,
           2.6421e+00,  4.2465e-01],
         ...,
         [-9.1637e-01, -2.9575e+00, -2.3527e+00,  ...,  3.8051e+00,
          -1.7508e+00, -3.0013e-02],
         [ 1.7159e+00, -5.4879e+00, -5.4453e+00,  ...,  2.2817e+00,
          -1.1848e+00,  3.6199e-01],
         [ 1.8603e+00, -1.4947e+00, -2.0976e+00,  ...,  1.0492e+00,
          -1.6670e-01,  1.0817e+00]],

        [[ 2.0825e-01,  5.5254e-01, -9.2371e-01,  ...,  4.0353e+00,
           6.0331e-01, -1.7102e-01],
         [ 6.9143e+00, -4.3192e-01,  2.0063e+00,  ..., -1.4493e+00,
           2.9736e+00,  3.0710e+00],
         [ 5.7035e+00, -1.5170e+00,  2.4971e+00,  ...,  7.1095e-01,
           3.4819e+00,  2.8955e+00],
         ...,
         [ 1.1284e+00,  4.9721e+00, -5.3145e-01,  ...,  2.0553e+00,
           5.8592e+00,  5.1771e-01],
         [ 1.5597e+00,  1.0363e+00, -4.0433e+00,  ...,  2.7590e-01,
          -6.0838e-01, -3.9250e-01],
         [-2.0624e-01,  3.2400e+00, -3.5715e-01,  ...,  1.6930e+00,
           5.3386e+00, -2.0960e-01]],

        [[ 3.1481e-01, -1.3198e+00, -1.1674e+00,  ...,  1.9761e+00,
          -1.7354e+00,  5.7905e-01],
         [ 8.6728e+00,  1.8406e+00, -2.7945e+00,  ..., -2.0082e-01,
           3.6898e+00,  2.3262e-01],
         [ 1.3709e+00,  3.7736e+00, -1.8413e+00,  ..., -2.1222e-02,
          -2.6678e+00,  3.4022e-01],
         ...,
         [ 8.8446e+00,  3.0429e+00,  7.8018e-02,  ...,  1.9613e+00,
           4.7537e-01,  7.3037e-01],
         [ 5.2987e+00, -1.9188e+00,  3.2341e+00,  ...,  9.9699e-01,
           3.3476e+00,  1.6811e+00],
         [ 5.6403e+00,  5.7391e-01,  1.4847e+00,  ..., -5.8498e-01,
           1.5177e+00,  1.2565e+00]]], device='xla:0'),)}
in for looooooop
This is,  0 torch.Size([32, 325, 1024])
